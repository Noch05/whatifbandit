% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mab_prep.R
\name{create_cutoff}
\alias{create_cutoff}
\title{Create Treatment Wave Cutoffs}
\usage{
create_cutoff(
  data,
  data_cols,
  period_length = NULL,
  assignment_method,
  time_unit
)
}
\arguments{
\item{data}{A data.frame, data.table, or tibble containing input data from the trial. This should be the results
of a traditional Randomized Controlled Trial (RCT). data.frames will be converted to tibbles internally.}

\item{data_cols}{A named character vector containing the names of columns in \code{data} as strings:
\itemize{
\item \code{id_col}: Column in \code{data}; contains unique ID as a key.
\item \code{success_col}: Column in \code{data}; binary successes from the original experiment.
\item \code{condition_col}: Column in \code{data}; original treatment condition for each observation.
\item \code{date_col}: Column in \code{data}; contains original date of event/trial. Only necessary when assigning by "Date". Must be of type \code{Date}, not a character string.
\item \code{month_col}: Column in \code{data}; contains month of treatment. Only necessary when \code{time_unit = "Month"}. This can be a string or factor variable
containing the names or numbers of months.
\item \code{success_date_col}: Column in \code{data}; contains original dates each success occurred. Only necessary when \code{perfect_assignment = FALSE}. Must be of type \code{Date}, not a character string.
\item \code{assignment_date_col}: Column in \code{data}; contains original dates treatments were assigned to observations. Only necessary when \code{perfect_assignment = FALSE}.
Used to simulate imperfect information on the part of researchers conducting an adaptive trial. Must be of type \code{Date}, not a character string.
}}

\item{period_length}{A numeric value of length 1; represents the length of each treatment period.
If assignment method is "Date", this refers to the
length of periods by your specified \code{time_unit} (i.e., if "Day", 10 would be 10 days).
If assignment method is "Batch", this refers to the number of people in each batch. This factor
contributes most to the computational cost of calling the function, as large batch sizes make each iteration of
the simulation run slower, while each additional period adds time because of the extra iterations.
If you have a large dataset, consider passing it as a data.table.}

\item{assignment_method}{A character string; one of "Date", "Batch", or "Individual", to define the assignment into treatment waves. When using
"Batch" or "Individual", ensure your dataset is pre-arranged in the proper order observations should be considered so that
groups are assigned correctly. For "Date", observations will be considered in chronological order.
"Individual" assignment can be time-consuming for larger datasets.}

\item{time_unit}{A character string specifying the unit of time for assigning periods when \code{assignment_method} is "Date".
Acceptable values are "Day", "Week", or "Month". "Month" is a special case that is useful when an experiment
defines the months differently then the genuine dates, i.e. an experiment considers August as starting
the in the second half of July, or when exact calender months are required for the periods, not just
a lengths of time in the month range. As such it requires an additional column to be provided,
with the exact month desired for each observation, and it treats each observation
as occurring on the first of that month. It is also useful when dates are not provided, here
synthetic dates should be created placing each observation on the first on its specified month.}
}
\value{
Updated tibble/data.table with the new \code{period_number} column. \code{period_number} is an integer
representing an observation's new assignment period.
}
\description{
Used to assign each observation a new treatment assignment period, based
on user-supplied specifications, and user supplied data from
\code{date_col} and \code{month_col} in \code{data_cols}, and the \code{period_length}. Creates a new
column indicating with period each observation belongs to, used for future subsetting.
}
\details{
The assignment periods do not strictly have to line up with the original experiment, it
is up to the researcher to test the possible options.

Month based assignment is a special case to be used when an experimenter wants
their periods to line up exactly with the calendar months, not just the length of a month.
This is useful for experiments that only track months, or define the calendar months differently
than the dates. For example if an experiment defines August as starting on July 17th, or
one where the passing of specific months is meaningful outside of time passed.
In this specification, an additional column must be provided that specifies the desired month
for each observation and each one is treated as if it occurred on the first of each month.
If only months are available, a synthetic date column will have to be provided,
simply make a date vector using the appropriate months with the proper year.

If months is simply the length of time wished for the period it would
be better to use day or week based, and set the \code{period_length} to an appropriate
30-31 days, or 4 weeks.
}
\keyword{internal}
