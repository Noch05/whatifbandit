% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mab_inference.R
\name{adaptive_aipw}
\alias{adaptive_aipw}
\title{Calculate Adaptive AIPW Estimates}
\usage{
adaptive_aipw(data, assignment_probs, conditions, periods, verbose)
}
\arguments{
\item{data}{A data.frame, data.table, or tibble containing input data from the trial. This should be the results
of a traditional Randomized Controlled Trial (RCT). data.frames will be converted to tibbles internally.}

\item{assignment_probs}{tibble/data.table containing the probabilities of being
assigned each treatment at a given period}

\item{conditions}{A named character vector containing treatment conditions. The elements
of this vector should be the names of each treatment as seen in your data, so to create it you can simply call
\code{unique(df[[condition_col_name]])}. The names of each element are used to reference the contents but are not inherently important;
choose names that are meaningful and consistent. If \code{control_augment} > 0, then the control condition
of the trial in this vector must have the name "Control".}

\item{periods}{Numeric value of length 1; number of total periods in the simulation}

\item{verbose}{A logical value; whether or not to print intermediate messages. Default is FALSE.}
}
\value{
tibble/data.table containing the AIPW estimate of treatment success, AIPW variance,
sample proportion of successful treatments (sample mean), and sample proportion variance.
}
\description{
Takes the average of the individual AIPW scores created by \code{\link[=get_iaipw]{get_iaipw()}} for each period,
and assigns each estimate an adaptive weight based on a constant allocation rate across periods defined by
\href{https://www.pnas.org/doi/full/10.1073/pnas.2014602118}{Hadad et. al (2021)} to calculate a final
AIPW estimate and variance for each treatment condition. Sample proportions are also provided
for comparison.
}
\details{
The formulas for the calculations in this function can be found in
\href{https://www.pnas.org/doi/full/10.1073/pnas.2014602118}{Hadad et al. (2021)} at
equation 5 (estimate), equation 11 (variance), equation 15 (allocation rate).

The formulas specified assume that each period is 1 observation but in the cases
for this simulation where periods contain multiple observations the individual estimates
from each period are averaged before being used in the final calculations.

The AIPW estimator makes corrections for the non-random method of assigning treatment,
and is both unbiased and asymptotically normal, so can be used fo statistical
inference, while the sample mean which is still provided for comparison, cannot be.
}
\references{
Hadad, Vitor, David A. Hirshberg, Ruohan Zhan, Stefan Wager, and Susan Athey. 2021.
“Confidence Intervals for Policy Evaluation in Adaptive Experiments.” \emph{Proceedings of the National Academy of Sciences of the United States of America} 118
(15): e2014602118. \doi{10.1073/pnas.2014602118}.
}
\keyword{internal}
