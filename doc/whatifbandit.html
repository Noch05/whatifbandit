<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to {whatifbandit}</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to
<code>{whatifbandit}</code></h1>



<p><code>{whatifbandit}</code> allows researchers to re-simulate their
randomized experiments under adaptive experimental designs. Replicating
experiments can be costly and time-consuming, so this simulation tool
allows researchers to explore what their results could have looked like
under an adaptive experimental design. These re-analyses can inform the
planning for future studies, allowing a researcher to justify an
adaptive design for a future project by understanding how such designs
help meet research and implementation goals.</p>
<p>Adaptive experimental designs randomly assigning treatments, but do
so while taking into account the relative performance of each treatment.
Usually this means that better performing treatments will be assigned
more participants at each assignment period, allowing both
identification of and assignment to the best treatment arm(s). These
designs can shine in situations such as:</p>
<ul>
<li>Finding and assigning the one best treatment takes precedence over
gauging the effects of all treatments with equal precision.</li>
<li>A researcher wants to test a many treatments, such as 10, 20, or
100.</li>
<li>Simple random assignment produces sample sizes too small to detect
the subset of treatment effects the researcher most cares about.</li>
<li>An experiment occurs over multiple time periods.</li>
</ul>
<p>This vignette introduces the key functions of the
<code>{whatifbandit}</code> package and how to use them effectively. All
that’s required is data from a previous randomized experiment containing
information about which treatment each observation was originally
assigned to, and the original outcome. For a more detailed view of the
exact adaptive procedures and implementation, please refer to the
function documentation, and if you encounter any bugs please report them
on the package’s <a href="https://github.com/Noch05/whatifbandit/issues">GitHub</a>
repository.</p>
<div id="core-functionality" class="section level1">
<h1>Core Functionality</h1>
<p><code>{whatifbandit}</code> provides 2 main functions for conducting
simulations, <code>single_mab_simulation()</code> and
<code>multiple_mab_simulation()</code>. Like their names suggest
<code>single_mab_simulation()</code> runs only 1 simulation while
<code>multiple_mab_simulation()</code> runs a user-specified number of
simulations. Internally both functions are similar, and share the same
arguments except for the few additional ones
<code>multiple_mab_simulation()</code> needs for repeated trials.</p>
<div id="multi-arm-bandits-adaptive-assignment" class="section level2">
<h2>Multi-Arm-Bandits: Adaptive Assignment</h2>
<p>Adaptive experiments are a form of multi-arm bandit (MAB) problem,
where each treatment arm has an unknown probability of success, and a
balance must be achieved between exploration and exploitation. In an
applied setting, we want a design that explores the space of possible
treatment options to find the best treatment, then exploit that best
treatment. If we do too much exploitation, we have the chance to miss
the true best treatment, but if we do too much exploration, then we miss
out on rewards from the best treatment. Additionally, these unknown
probabilities can change overtime in what is called a non-stationary
bandit problem. Solutions to these bandit problems, in the form of
decision algorithms, provide the basis for how
<code>{whatifbandit}</code> simulates an adaptive trial.</p>
<p><code>{whatifbandit}</code> supports 2 assignment algorithms,
Thompson sampling and upper confidence bound assignment (“UCB1”).
Thompson sampling calculates the posterior probability of each treatment
being the best treatment arm, and then uses those probabilities to
assign the treatment arms in the next wave. In the Bernoulli case
implemented in <code>{whatifbandit}</code>, the posterior probabilities
can be calculated from a beta distribution. On the other hand, UCB1
instead calculates an upper confidence bound on the expected reward of
each arm, and selects the maximum value <span class="citation">(Kuleshov
and Precup 2014; Slivkins 2024; Offer-Westort, Coppock, and Green
2021)</span>.</p>
<p>In a multi-arm experiment with <span class="math inline">\(T\)</span>
time periods, let the set of potential treatment arms be denoted by
<span class="math inline">\(\mathcal{K}\)</span>. At each time period
<span class="math inline">\(t \in \{1, 2, ..., T\}\)</span>, a treatment
arm $W_t $ needs to be selected for all the treatments.</p>
<p>In Thompson sampling, this involves finding the arm <span class="math inline">\(w \in \mathcal{K}\)</span> with the highest
probability of being the best treatment arm. When outcomes are binary,
the probability of a reward from any arm <span class="math inline">\(k
\in \mathcal{K}\)</span> after wave <span class="math inline">\(t-1\)</span> of the adaptive procedure, denoted
<span class="math inline">\(\theta^k_t\)</span>, follows a beta
distribution according to the number of observed success and failures
the treatment has received up to that point. These cumulative successes
and failures are for each arm are denoted, <span class="math inline">\(\text{success}_{kt}\)</span> and <span class="math inline">\(\text{failures}_{kt}\)</span> respectively. Now
instead of choosing the arm <span class="math inline">\(w\)</span> which
has the highest probability of being the best as the one <span class="math inline">\(W_t\)</span>, Thompson sampling uses these
probabilities to assign new treatments, so the probability that each arm
<span class="math inline">\(w\)</span> is the best becomes the
probability that it will be assigned from the set of <span class="math inline">\(\mathcal{K}\)</span> arms at time <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
P(W_t = w) = P\left(\theta_t^w &gt; \theta_t^k,  \ \forall k \in
\mathcal{K} \setminus \{w\} \mid \ \theta^k_t \sim
\text{Beta}(1+\text{success}_{kt}, 1 + \text{failures}_{kt}) \ \forall k
\in \mathcal{K}\right)
\]</span> For UCB1 only 1 treatment arm is selected at any time <span class="math inline">\(t\)</span>. <span class="math inline">\(W_t\)</span>, the selected treatment at time <span class="math inline">\(t\)</span>, is the treatment arm <span class="math inline">\(k \in \mathcal{K}\)</span> which maximizes the sum
of the estimated expected reward and the uncertainty bound at time <span class="math inline">\(t\)</span>, where <span class="math inline">\(n_{kt}\)</span> is the number of times arm <span class="math inline">\(k\)</span> has been selected up to time <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
W_t = \arg\max_k  \left(\widehat{\mathbb{E}[\text{Reward}_{kt}]} +
\sqrt{\frac{2 \ln t}{n_{kt}}} \right)
\]</span></p>
</div>
<div id="adaptive-inference" class="section level2">
<h2>Adaptive Inference</h2>
<p>Statistical inference under adaptive designs requires careful
consideration. The sample mean is biased for the true reward
probability, because observations are no longer independently
identically distributed (i.i.d.). Thus, we utilize an augmented inverse
probability weighted estimator (AIPW), with a constant allocation of the
variance across periods formulated by <span class="citation">Hadad et
al. (2021)</span>, whose formulas we implement in the package. These
estimators are unbiased and asymptotically normal under adaptive trials,
so a normal distribution can be used for parametric inference.
Additionally, <code>{whatifbandit}</code> also allows for multiple
simulations to easily estimate the variance of the procedure, and build
an empirical distribution of the unbiased AIPW estimates, instead of
just relying on the normal approximation.</p>
<p>The estimator is calculated by weighting the outcome against the
probability of being assigned the treatment, and a conditional
expectation/regression estimate based on the previous periods of
assignment, then aggregating based on an adaptive weight. In the package
the conditional expectation is estimated via a grouped mean, and the
adaptive weight uses the constant allocation rate described in <span class="citation">Hadad et al. (2021)</span>. The allocation rate is a
function which describes the proportion of the remaining variance that
is allocated for next observation. This allocation rate determines how
the adaptive weights are used which are necessary to ensure the variance
of the estimator converges properly. Additional details about adaptive
weights, and allocation functions can be found in <span class="citation">Hadad et al. (2021)</span>, along with the other
specifications they tested. The formulas below are adapted from the
<span class="citation">Hadad et al. (2021)</span>, and showcase the AIPW
calculations.</p>
<p>The first equation below gives the individual AIPW estimate for
treatment <span class="math inline">\(w\)</span> and at period <span class="math inline">\(t\)</span>, where <span class="math inline">\(\mathbb{I}\)</span> is an indicator function,
<span class="math inline">\(e_t(w)\)</span> is the probability of unit
in period <span class="math inline">\(t\)</span> being assigned
treatment <span class="math inline">\(w\)</span>, and <span class="math inline">\(\hat{m}_t(w)\)</span> is conditional
expectation/regression estimate based on the previous periods of
assignment. The regression estimate at period <span class="math inline">\(t\)</span>, is the average of the outcomes under
treatment <span class="math inline">\(w\)</span>, from periods <span class="math inline">\(t-1\)</span>, where <span class="math inline">\(n_{t-1}(w)\)</span> is the number of times
treatment <span class="math inline">\(w\)</span> was assigned by period
<span class="math inline">\(t-1\)</span>.</p>
<p>The second equation below gives the final AIPW estimate for treatment
<span class="math inline">\(w\)</span>, and is the weighted sum of each
individual estimate <span class="math inline">\(\widehat{\Gamma}^{AIPW}_t\)</span> and the
adaptive weights <span class="math inline">\(h_t(w)\)</span> for
treatment <span class="math inline">\(w\)</span> at time <span class="math inline">\(t\)</span>, all divided by the sum of the weights.
These adaptive weights are calculated in the third equation below by
dividing current probability of being assigned treatment, <span class="math inline">\(e_t(w)\)</span>, by the total number of periods,
<span class="math inline">\(T\)</span>, and taking the square root.</p>
<p><span class="math display">\[
\widehat{\Gamma}^{AIPW}_t = \frac{\mathbb{I}\{W_t = w\}}{e_t(w)} Y_t +
\left(1 - \frac{\mathbb{I}\{W_t = w\}}{e_t(w)} \right)\hat{m}_t(w) \tag
{Individual} \\
\]</span> <span class="math display">\[
\widehat{Q}^h_T(w) =
\frac{\sum_{t=1}^Th_t(w)\widehat{\Gamma}^{AIPW}_t}{\sum_{t=1}^Th_t(w)}
\tag{Average}
\]</span> <span class="math display">\[
h_t(w) = \sqrt{\frac{e_t(w)}{T}} \tag{Adaptive Weight} \\
\]</span> <span class="math display">\[
\hat{m}_t(w) = \frac{1}{n_{t-1}(w)}\sum_{i=1}^{n_{t-1}(w)} y_i
\tag{Grouped Mean}
\]</span></p>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>To explore the functionality of <code>{whatifbandit}</code>, we will
use the included <code>tanf</code> dataset. These data detail the
results of a randomized experiment, which tested the impact of different
letters on re-certification for the Temporary Assistance for Needy
Families (TANF) program in Washington D.C. <span class="citation">(Moore
et al. 2022)</span>. The original field experiment tests 3 different
conditions, over the course of 5 months.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">data</span>(tanf)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">glimpse</span>(tanf)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Rows: 3,517</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Columns: 21</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; $ ic_case_id                       &lt;chr&gt; &quot;42c43695d7d06af7f66fd072c3ee2593&quot;, &quot;…</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; $ service_center                   &lt;chr&gt; &quot;Anacostia&quot;, &quot;Anacostia&quot;, &quot;Congress_H…</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; $ appt_date                        &lt;date&gt; 2017-06-26, 2017-06-26, 2017-06-26, …</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; $ condition                        &lt;fct&gt; no_letter, no_letter, no_letter, no_l…</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; $ recert_month                     &lt;fct&gt; July, July, July, July, July, July, J…</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; $ letter_sent_date                 &lt;date&gt; 2017-06-19, 2017-06-19, 2017-06-19, …</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; $ recert_id                        &lt;dbl&gt; 151516, 153505, 151887, 155288, 15033…</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; $ return_to_sender                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; $ pdc_status                       &lt;chr&gt; &quot;Closed&quot;, &quot;Closed&quot;, &quot;Pending closure&quot;…</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; $ renewal_date                     &lt;date&gt; 2017-07-31, 2017-07-31, 2017-07-31, …</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; $ notice_date.x                    &lt;date&gt; 2017-05-29, 2017-05-29, 2017-05-29, …</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; $ days_betwn_notice_and_recert_due &lt;dbl&gt; 63, 63, 63, 63, 63, 63, 63, 63, 63, 6…</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; $ cert_period_start                &lt;date&gt; 2016-11-01, 2017-03-07, 2016-11-01, …</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; $ cert_period_end                  &lt;date&gt; 2017-07-31, 2017-07-31, 2017-07-31, …</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; $ recert_status                    &lt;chr&gt; &quot;Notice Sent&quot;, &quot;Notice Sent&quot;, &quot;Notice…</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; $ denial_reason                    &lt;chr&gt; &quot;No response from client&quot;, &quot;No respon…</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt; $ recert_month_year                &lt;chr&gt; &quot;July 2017&quot;, &quot;July 2017&quot;, &quot;July 2017&quot;…</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt; $ notice_date.y                    &lt;date&gt; 2017-05-29, 2017-05-29, 2017-05-29, …</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt; $ recert_status_dcas               &lt;chr&gt; &quot;Denied due to failure of action&quot;, &quot;D…</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt; $ date_of_recert                   &lt;date&gt; NA, NA, NA, 2017-06-27, NA, NA, NA, …</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt; $ success                          &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0…</span></span></code></pre></div>
</div>
</div>
<div id="a-single-mab-simulation" class="section level1">
<h1>A Single MAB Simulation</h1>
<p><code>single_mab_simulation()</code> runs an adaptive-design
simulation, where each of its arguments tunes the settings of the
simulation. A simulation requres a data frame containing a unique ID for
every row, that row’s original treatment, and its original outcome.
These column names are passed to the function as strings.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">single_mab_simulation</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">data =</span> tanf,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">assignment_method =</span> <span class="st">&quot;Batch&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">period_length =</span> <span class="dv">1000</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">&quot;UCB1&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">whole_experiment =</span> <span class="cn">TRUE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">prior_periods =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">blocking =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="at">id_col =</span> <span class="st">&quot;ic_case_id&quot;</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  )</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>)</span></code></pre></div>
<p>The function contains several options which control the specification
of the simulation. The setup above performs UCB1 sampling without
treatment blocking with batch sizes of 1000 people, where the whole
experiment is used for imputing outcomes. This differs significantly
from the original TANF field experiment.</p>
<p>The original TANF experiment was blocked by D.C. Community and Human
Services service centers (and by official appointment date), ensuring
each center had a comparable number of participants in each group. To
replicate this we set <code>block = TRUE</code> and add the
service_center column to <code>block_cols</code> <span class="citation">(Moore et al. 2022)</span>.</p>
<p>The original experiment took place over 5 distinct months. To mirror
that, we set <code>assignment_method = &quot;Date&quot;</code>,
<code>time_unit = &quot;Month&quot;</code>, and <code>period_length = 1</code>,
which creates 1-month-long periods. With a date assignment, the name of
<code>date_col</code> needs to be provided in
<code>data_cols</code>.</p>
<p>UCB1 sampling also only chooses 1 treatment per period, but because
we want time-based periods, and each period is a large portion of the
dataset, we use Thompson sampling instead. This ensures that we can see
the treatment assignments evolve more over time. We sset
<code>algorithm = &quot;Thompson&quot;</code> for this.</p>
<p>The time component of the experiment can be further taken into
account. There is no guarantee, that by the time next month’s letters
are sent out, that all the people who would recertify had done so.
Additionally, when <code>whole_experiment = TRUE</code>, the full set of
original results is used for outcome imputation, while setting it to
FALSE only uses the data up to the assignment period, which more closer
reflects the information available, had the original experiment been a
MAB. To reflect these conditions, we set
<code>perfect_assignment = FALSE</code>, and
<code>whole_experiment = FALSE</code>, along with including
<code>success_date_col</code> and <code>assignment_date_col</code> in
<code>data_cols</code>.</p>
<p>With this configuration, if a success occurs after the date
treatments are assigned, it is masked and treated as a failure. This
simulates the researcher’s limited information as those late outcomes
would not have been observed yet.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">single_mab_simulation</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">data =</span> tanf,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">assignment_method =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">time_unit =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">period_length =</span> <span class="dv">1</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">&quot;Thompson&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">whole_experiment =</span> <span class="cn">FALSE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">prior_periods =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="at">blocking =</span> <span class="cn">TRUE</span>, <span class="at">block_cols =</span> <span class="fu">c</span>(<span class="st">&quot;service_center&quot;</span>),</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="at">id_col =</span> <span class="st">&quot;ic_case_id&quot;</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="at">date_col =</span> <span class="st">&quot;appt_date&quot;</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span>,</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="at">month_col =</span> <span class="st">&quot;recert_month&quot;</span>,</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    <span class="at">success_date_col =</span> <span class="st">&quot;date_of_recert&quot;</span>,</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="at">assignment_date_col =</span> <span class="st">&quot;letter_sent_date&quot;</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  )</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>)</span></code></pre></div>
<p>You don’t always have to replicate the setting perfectly, reanalyzing
the experiment as an adaptive trial also involves testing how the
results change across different configurations, such as the size and
length of periods, or the usage of <code>perfect_assignment</code> or
<code>whole_experiment</code>. The only guidelines would be to use UCB1
only when the period size is a relatively small component of the
dataset, and only set <code>perfect_assignment = FALSE</code>, when you
have dates that line up the periods you have set. If this is not the
case, then all the successes will simply be masked.</p>
<p>For example, we can experiment with using individual assignment, by
setting <code>assignment_method = &quot;Individual&quot;</code>. This does not
follow the original experiment, and we don’t have data in that form, so
<code>perfect_assignment = TRUE</code> should be set for the best
results. Additionally, since the date still represents the order, we
sort the data before running the simulation, to ensure it’s in the
observed order.</p>
<p>It also may be strong assumption that the true probabilities of
success for each treatment are stationary over time. To account for
this, I can set <code>prior_periods = 500</code>, to only look at the
last 500 periods, in the <code>&quot;Individual&quot;</code> case, observations,
in the simulation when performing adaptive assignment. This ensures that
the oldest periods, which might not be representative of the true
current probabilities, are not considered when assigning new
treatments.</p>
<p>Additionally, because the goal of this experiment is also to estimate
a treatment effect for the letters, we might not want to leave 100% of
the assignment up to the bandit algorithms. For this we have two
methods, either control augmentation or a hybrid design.</p>
<p>Control augmentation ensures that the marked control group meets the
specified probability threshold for assignment. For example, if we set
<code>control_augment = 0.25</code>, the algorithm allocates 25% of each
period to be assigned to the control group, and if a period has the
control group at 15%, then the probabilities are adjusted
accordingly.</p>
<p>The hybrid design sets aside a percentage of the dataset to be
assigned uniformly randomly. If we set
<code>random_assign_prop = 0.2</code>, then the algorithm allocates 20%
of each period to be assigned to treatments randomly, while 80% are
assigned via the Thompson sampling or UCB1 algorithm.</p>
<p>We do not recommend using both control augmentation and a hybrid
design. If there are 3 conditions, like in the TANF experiment, and we
set <code>control_augment = 0.1</code>, and
<code>random_assign_prop = 0.21</code>, then the minimum assignment
probability for the control group is not 10% but 14.9% instead (0.1 *
0.79 + 0.21/3 = 0.149). Below, we use
<code>control_augment = 0.2</code>, and identify the control group using
the <code>control_condition</code> argument. If we use
<code>random_assign_prob</code> instead, we do not need to specify
this.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tanf <span class="ot">&lt;-</span> <span class="fu">arrange</span>(tanf, appt_date)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>conditions <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">levels</span>(tanf<span class="sc">$</span>condition), <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T2&quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">single_mab_simulation</span>(</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">data =</span> tanf,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">assignment_method =</span> <span class="st">&quot;Individual&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">&quot;Thompson&quot;</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">whole_experiment =</span> <span class="cn">FALSE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">prior_periods =</span> <span class="dv">500</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">blocking =</span> <span class="cn">TRUE</span>, <span class="at">block_cols =</span> <span class="fu">c</span>(<span class="st">&quot;service_center&quot;</span>),</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="at">id_col =</span> <span class="st">&quot;ic_case_id&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  ),</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">control_augment =</span> <span class="fl">0.2</span>,</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">control_condition =</span> <span class="st">&quot;no_letter&quot;</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>)</span></code></pre></div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<p><code>single_mab_simulation()</code> returns a list with 4
components:</p>
<ul>
<li><code>final_data</code> is the transformed input containing the
treatment assignments and outcomes from the simulation, along with other
new columns such as the probability of being assigned each treatment at
each period, and the regression adjustment <span class="math inline">\(\hat{m}(W)\)</span> for the AIPW estimates.</li>
<li><code>bandits</code> contains either the Thompson sampling
probabilities or UCB1 values from each period in the trial. The chart
should be interpreted as the bandit calculation after that period
occurred.</li>
<li><code>assignment_probs</code> contains the probability of assignment
from each period in the trial. The chart should be interpreted as the
probability for that specific period.</li>
<li><code>estimates</code> contains the AIPW and sample estimates with
variances for each treatment arm.</li>
<li><code>settings</code> contains the configuration for the
simulation.</li>
</ul>
<p>This object is also a custom <code>mab</code> class, that comes with
several generic methods. The <code>print()</code> method displays the
settings of the trial, and the <code>summary()</code> method aggregates
the results.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">class</span>(sim)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;mab&quot;  &quot;list&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>sim</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; Summary for MAB Procedure: </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;  ----------------------------------------------------- </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; Bandit Algorithm:      thompson </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Control Augmentation:  0 </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; Bandit Assignment:     1 </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Randomized Assignment: 0 </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; Perfect Assignment:    TRUE </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; Whole Experiment:      FALSE </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; Blocking Variables:    service_center </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; Assignment Method:     date </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; Period Length:         1 month</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Total Periods:         5 periods</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; Prior Periods:         all periods</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Number of Treatments:  3 </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------------</span></span></code></pre></div>
<p>The summary method presents the final Thompson/UCB1 calculation from
after the trial concluded, the AIPW estimate for the probability of
success, its standard error, a 95% two-tailed confidence interval based
on a normal distribution, and the number of observations assigned to
each treatment group over the course of the trial.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>sim_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(sim)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">print</span>(sim_summary, <span class="at">width =</span> <span class="cn">Inf</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 9</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;   Treatment_Arm Probability_Of_Best_Arm estimated_probability_of_success     SE</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                           &lt;dbl&gt;                            &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; 1 no_letter                     0.00220                            0.375 0.0111</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; 2 open_appt                     0.903                              0.446 0.0132</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; 3 specific_appt                 0.0950                             0.421 0.0118</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;   lower_bound upper_bound num_assigned level periods</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; 1       0.353       0.397          457  0.95       5</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; 2       0.420       0.471         1977  0.95       5</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; 3       0.398       0.444         1083  0.95       5</span></span></code></pre></div>
<p>The width of the confidence intervals can be changed in the
<code>level</code> argument of the summary method, but can also be
calculated by hand using the standard error. Below, we specify 80%
confidence intervals or an <span class="math inline">\(\alpha =
0.2\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Inside Summary Call</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">summary</span>(sim, <span class="at">level =</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">select</span>(estimated_probability_of_success, SE, lower_bound, upper_bound, level) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;   estimated_probability_of_success     SE lower_bound upper_bound level</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;                              &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 1                            0.375 0.0111       0.361       0.389   0.8</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 2                            0.446 0.0132       0.429       0.463   0.8</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 3                            0.421 0.0118       0.406       0.436   0.8</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co"># By hand</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.2</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>sim_summary <span class="sc">|&gt;</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    <span class="at">lower_bound =</span> estimated_probability_of_success <span class="sc">-</span> SE <span class="sc">*</span> quantile,</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>    <span class="at">upper_bound =</span> estimated_probability_of_success <span class="sc">+</span> SE <span class="sc">*</span> quantile</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>  <span class="fu">select</span>(estimated_probability_of_success, SE, lower_bound, upper_bound)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;   estimated_probability_of_success     SE lower_bound upper_bound</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt;                              &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; 1                            0.375 0.0111       0.361       0.389</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; 2                            0.446 0.0132       0.429       0.463</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; 3                            0.421 0.0118       0.406       0.436</span></span></code></pre></div>
</div>
<div id="plotting" class="section level2">
<h2>Plotting</h2>
<p>Plot methods display the results. These methods use
<code>{ggplot2}</code> to create visualizations. The <code>mab</code>
class supports 3 plot types, <code>&quot;arm&quot;</code>, <code>&quot;assign&quot;</code>
and <code>&quot;estimate&quot;</code>, each providing different information about
the results. These plots can be built with <code>+</code> like any
<code>{ggplot2}</code> object, and arguments to the main
<code>geom*</code> can be specified through the <code>...</code>
argument. The geoms used are <code>geom_line()</code>, and
<code>geom_errorbarh()</code>.</p>
<p><code>type = &quot;arm&quot;</code> provides a view of each arm over time, its
relative probability of being the best, or the UCB1 value.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(sim, <span class="at">type =</span> <span class="st">&quot;arm&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><code>type = &quot;assign&quot;</code> showcases the assignment probability for
that arm overtime.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(sim, <span class="at">type =</span> <span class="st">&quot;assign&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><code>type = &quot;estimate&quot;</code> shows error bars on the AIPW using the
estimated variances. Just like the <code>summary()</code>, the
confidence level can be specified.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot</span>(sim, <span class="at">type =</span> <span class="st">&quot;estimate&quot;</span>, <span class="at">level =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">range</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>All of the data used to create these plots and summary statistics is
present in the original output, so you can easily create your own more
detailed versions. Additionally, the information provided should also
let you calculate other adaptive estimators, if you do not want to use
the AIPW from <span class="citation">Hadad et al. (2021)</span> or want
to specify another one of their proposed adaptive variance allocation
methods.</p>
</div>
</div>
<div id="multiple-simulations" class="section level1">
<h1>Multiple Simulations</h1>
<p><code>multiple_mab_simulation()</code> is a wrapper function for
executing multiple trials under the same settings. It is used to
estimate the variance in the outcomes that occurs from the simulation
process. Depending on the number of trials specified and the size of
your dataset, running multiple simulations can be memory intensive, and
have a long run time, so we recommend that running a single simulation
first to estimate how long multiple simulations will take.</p>
<p><code>multiple_mab_simulation()</code> has 3 new arguments but is
otherwise the same as <code>single_mab_simulation()</code>. These
arguments are:</p>
<ul>
<li><code>times</code>: The number of times to run the simulation.</li>
<li><code>seeds</code>: A numeric vector of random seeds, where
<code>length(seeds) = times</code>. Required to make results
reproducible, and we encourage setting them before hand using
<code>sample.int()</code>.</li>
<li><code>keep_data</code>: A logical value, whether or not to keep the
<code>final_data</code> object from each simulation. Default is FALSE,
to reduce memory load of execution.</li>
</ul>
<p>Below, we re-simulate the TANF experiment as 100 MAB trials:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">532454</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000000</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">system.time</span>(</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  multiple_sims <span class="ot">&lt;-</span> <span class="fu">multiple_mab_simulation</span>(</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">data =</span> tanf,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">assignment_method =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">time_unit =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">period_length =</span> <span class="dv">1</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="at">algorithm =</span> <span class="st">&quot;Thompson&quot;</span>,</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="at">whole_experiment =</span> <span class="cn">FALSE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">prior_periods =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    <span class="at">blocking =</span> <span class="cn">TRUE</span>, <span class="at">block_cols =</span> <span class="fu">c</span>(<span class="st">&quot;service_center&quot;</span>),</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>      <span class="at">id_col =</span> <span class="st">&quot;ic_case_id&quot;</span>,</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>      <span class="at">date_col =</span> <span class="st">&quot;appt_date&quot;</span>,</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>      <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>      <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span>,</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>      <span class="at">month_col =</span> <span class="st">&quot;recert_month&quot;</span>,</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>      <span class="at">success_date_col =</span> <span class="st">&quot;date_of_recert&quot;</span>,</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>      <span class="at">assignment_date_col =</span> <span class="st">&quot;letter_sent_date&quot;</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>    ),</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>    <span class="at">keep_data =</span> <span class="cn">TRUE</span>, <span class="at">times =</span> <span class="dv">100</span>, <span class="at">seeds =</span> seeds</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  )</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>)</span></code></pre></div>
<p>Here we’ve kept <code>keep_data = TRUE</code> to showcase the memory
impact of saving the data from each iteration. The full object size with
all the data is 134 megabytes (MiB). However, when we remove the data
from the object, the size becomes just 963 kilobytes (KiB), making it
142 times smaller than the original size.</p>
<p>Executing those 100 simulations took 15.47 seconds. To speed up this
process <code>multiple_mab_simulation()</code> supports parallel
processing via the <a href="https://furrr.futureverse.org/">furrr</a>
and <a href="https://furrr.futureverse.org/">future</a> packages. To run
the function in parallel, call <code>future::plan()</code> before
running it and specify the number of cores you want to use.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">532454</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>seeds <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">1000000</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">plan</span>(<span class="st">&quot;multisession&quot;</span>, <span class="at">workers =</span> <span class="dv">4</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>parallel_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>(</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  multiple_sims <span class="ot">&lt;-</span> <span class="fu">multiple_mab_simulation</span>(</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="at">data =</span> tanf,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="at">assignment_method =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="at">time_unit =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="at">period_length =</span> <span class="dv">1</span>,</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="at">algorithm =</span> <span class="st">&quot;Thompson&quot;</span>,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    <span class="at">whole_experiment =</span> <span class="cn">FALSE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>    <span class="at">prior_periods =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    <span class="at">blocking =</span> <span class="cn">TRUE</span>, <span class="at">block_cols =</span> <span class="fu">c</span>(<span class="st">&quot;service_center&quot;</span>),</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>    <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>      <span class="at">id_col =</span> <span class="st">&quot;ic_case_id&quot;</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>      <span class="at">date_col =</span> <span class="st">&quot;appt_date&quot;</span>,</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>      <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>      <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span>,</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>      <span class="at">month_col =</span> <span class="st">&quot;recert_month&quot;</span>,</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>      <span class="at">success_date_col =</span> <span class="st">&quot;date_of_recert&quot;</span>,</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>      <span class="at">assignment_date_col =</span> <span class="st">&quot;letter_sent_date&quot;</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>    ),</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>    <span class="at">keep_data =</span> <span class="cn">FALSE</span>, <span class="at">times =</span> <span class="dv">100</span>, <span class="at">seeds =</span> seeds</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  )</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>)</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="fu">plan</span>(<span class="st">&quot;sequential&quot;</span>)</span></code></pre></div>
<p>Using 4 cores, it only takes 8.71 seconds to run 100 simulations.
Your core usage is determined by your system requirements. To see how
many cores are available on your system call
<code>future::availableCores()</code>.</p>
<p>Using <code>{future}</code> comes with some new complexities.
Generally, Windows users should use <code>plan(&quot;multisession&quot;)</code>,
while Linux and MacOS users should use <code>plan(&quot;multisession&quot;)</code>
or <code>plan(&quot;multicore&quot;)</code>. If you are using a High Performance
Computing cluster, use the <code>future.batchtools</code> backend with
the proper plan for your HPC scheduler. For details on how
<code>futures</code> work, and specific future backends, please consult
the <a href="https://future.futureverse.org/">future</a>
documentation.</p>
<div id="analyzing-repeated-simulations" class="section level2">
<h2>Analyzing Repeated Simulations</h2>
<p><code>multiple_mab_simulation()</code> returns the mostly the same
elements as <code>single_mab_simulation()</code> except for
<code>final_data</code>. When <code>keep_data = TRUE</code> the
<code>final_data</code> element is a nested data frame of all the
<code>final_data</code> from each trial, and when
<code>keep_data = FALSE</code>, the function returns only objects
<code>bandits</code>, <code>assignment_probs</code>,
<code>estimates</code>, <code>assignment_quantities</code> and
<code>settings</code>. <code>assignment_quantities</code> is a new
object, which is the same structure as <code>bandits</code> and
<code>assignment_probs</code> but contains the number of units assigned
to each treatment for each trial.</p>
<p>The object is also a custom <code>multiple.mab</code> class
containing similar generic methods as the <code>mab</code> class,
including <code>print()</code> and <code>summary()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">class</span>(multiple_sims)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;multiple.mab&quot; &quot;list&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">print</span>(multiple_sims)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; Summary for MAB Procedure: </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt;  ----------------------------------------------------- </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; Bandit Algorithm:      thompson </span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; Control Augmentation:  0 </span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; Bandit Assignment:     1 </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; Randomized Assignment: 0 </span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; Perfect Assignment:    TRUE </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; Whole Experiment:      FALSE </span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; Blocking Variables:    service_center </span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; Assignment Method:     date </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; Period Length:         1 month</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; Total Periods:         5 periods</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; Prior Periods:         all periods</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; Number of Treatments:  3 </span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; Trials Conducted:      100 trials</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; Keep Final Data:       FALSE </span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------------</span></span></code></pre></div>
<p>For <code>multiple.mab</code> objects, <code>summary()</code> returns
the average for AIPW estimates and 2 estimates of their standard error.
One estimate is the average of the standard errors across each trial,
with the variances averaged first <span class="math inline">\(\left(\sqrt{\frac{1}{\text{n}}\sum_1^n\mathbb{V}[\text{Estimate}_i]}\right)\)</span>.
The other estimate, is the sample variance of all of the AIPW estimates
across the trials (<code>SE_empirical</code>). 95% confidence intervals
are provided using both the empirical cumulative distribution function
(eCDF), and the normal CDF using the average standard errors.
Additionally, the number of times each treatment arm was selected as the
best is displayed, along with the mean and standard deviation of the
number of units assigned to each treatment across the trials. The best
arm for a given simulation is selected as the treatment arm with the
highest Thompson sampling probability or UCB1 value at the end of the
trial.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">summary</span>(multiple_sims) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 12</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;   Treatment_Arm average_probability_of_success SE_avg SE_empirical lower_normal</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                                  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; 1 no_letter                              0.383 0.0124      0.00913        0.359</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; 2 open_appt                              0.444 0.0120      0.00555        0.420</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; 3 specific_appt                          0.421 0.0107      0.00774        0.400</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt;   upper_normal lower_empirical upper_empirical times_best level</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; 1        0.401           0.367           0.402          0  0.95</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; 2        0.455           0.430           0.452         98  0.95</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; 3        0.436           0.405           0.434          2  0.95</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;   average_num_assigned sd_num_assigned</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;                  &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; 1                 471.            59.6</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; 2                1890.           238. </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; 3                1156.           224.</span></span></code></pre></div>
<p>Just like with <code>mab</code> objects, the confidence levels can be
changed in the <code>summary()</code> call.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">summary</span>(multiple_sims, <span class="at">level =</span> <span class="fl">0.75</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 12</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt;   Treatment_Arm average_probability_of_success SE_avg SE_empirical lower_normal</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                                  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; 1 no_letter                              0.383 0.0124      0.00913        0.369</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; 2 open_appt                              0.444 0.0120      0.00555        0.430</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; 3 specific_appt                          0.421 0.0107      0.00774        0.409</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt;   upper_normal lower_empirical upper_empirical times_best level</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt;          &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; 1        0.394           0.374           0.395          0  0.75</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; 2        0.450           0.439           0.449         98  0.75</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; 3        0.430           0.413           0.429          2  0.75</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;   average_num_assigned sd_num_assigned</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt;                  &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; 1                 471.            59.6</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; 2                1890.           238. </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; 3                1156.           224.</span></span></code></pre></div>
</div>
<div id="plotting-repeated-simulations" class="section level2">
<h2>Plotting Repeated Simulations</h2>
<p><code>multiple.mab</code> objects also have their own plot method
with 3 distinct plots: <code>&quot;summary&quot;</code>, <code>&quot;hist&quot;</code>, and
<code>&quot;estimate&quot;</code>. Just like with <code>mab</code> these plots are
created using <code>{ggplot2}</code>, so can be added to with
<code>+</code> and arguments in <code>...</code> can be passed to the
<code>geom*</code> functions inside. The geoms used are
<code>geom_bar()</code>, <code>geom_histogram()</code>, and
<code>geom_errorbarh()</code>.</p>
<p><code>type = &quot;summary&quot;</code> creates a bar graph showing how many
times each treatment arm was selected as the best:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(multiple_sims, <span class="at">type =</span> <span class="st">&quot;summary&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><code>type = &quot;hist&quot;</code> creates histograms showcasing the
distribution for the AIPW for each treatment arm, over the repeated
trials or the distribution of the number of units assigned to each
treatment arm. For this function because it also takes advtanage of
<code>facet_grid()</code>, additional arguments need to be specified in
a list labelled <code>geom</code> for items to go to
<code>geom_histogram()</code> and <code>facet</code> for items to go to
<code>facet_grid()</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(multiple_sims, <span class="at">type =</span> <span class="st">&quot;hist&quot;</span>, <span class="at">quantity =</span> <span class="st">&quot;estimate&quot;</span>, <span class="at">geom =</span> <span class="fu">list</span>(<span class="at">bins =</span> <span class="dv">50</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(multiple_sims, <span class="at">type =</span> <span class="st">&quot;hist&quot;</span>, <span class="at">quantity =</span> <span class="st">&quot;assignment&quot;</span>, <span class="at">facet =</span> <span class="fu">list</span>(<span class="at">switch =</span> <span class="st">&quot;x&quot;</span>))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><code>type = &quot;estimate&quot;</code> is the same as for <code>mab</code>,
but now the spread can be shown using either empirical or normal
CDF.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot</span>(multiple_sims, <span class="at">type =</span> <span class="st">&quot;estimate&quot;</span>,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="at">cdf =</span> <span class="st">&quot;empirical&quot;</span>, <span class="at">level =</span> <span class="fl">0.99</span>, <span class="at">height =</span> <span class="fl">0.4</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">range</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>All the data used to construct these plots is available in the
output, so users can perform custom analyses or make custom plots.</p>
</div>
</div>
<div id="additional-topics" class="section level1">
<h1>Additional Topics</h1>
<div id="large-datasets" class="section level2">
<h2>Large Datasets</h2>
<p>Both <code>single_mab_simulation()</code> and
<code>multiple_mab_simulation()</code> have support for large data
objects through <code>{data.table}</code>. When working with large
datasets, data.tables are faster with common operations and more memory
efficient than data.frames or tibbles, so using them can result in
faster simulations.</p>
<p>To turn a data.frame into a data.table simply call
<code>data.table::setDT()</code> on your data.frame. Below, solely in
order to gauge execution times, we <code>rbind()</code> the
<code>tanf</code> dataset to itself several times to create a large
object.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Prepare the dataset:</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>tanf_large <span class="ot">&lt;-</span> tanf</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">setDT</span>(tanf_large)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  tanf_large <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(tanf_large, tanf_large))</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>}</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="fu">setorder</span>(tanf_large, appt_date)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co"># Set id to be the row number for uniqueness:</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>tanf_large[, id <span class="sc">:=</span> .I] </span></code></pre></div>
<p>Now <code>tanf_large</code> has 1800704 rows to simulate over instead
of 3517. For this example, the batch size will be 3000 people, resulting
in 601 periods.</p>
<p>When using large datasets in conjunction with Thompson sampling, the
direct calculation can fail. In the event of a failure, an attempt will
be made to estimate the Thompson sampling probability by simulation
draws from the posterior distribution. The number of these draws is set
by the <code>ndraws</code> argument, which defaults to 5000, and you can
change based on how accurate or fast you want the calculation to be.
This simulation still has the potential to fail, and if it does, an
error will be thrown. If this occurs, we recommend you change
<code>prior_periods</code> from “All” to a lower number which limits the
size data used for Thompson sampling in each period, or use the UCB1 as
the decision algorithm instead.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">523432453</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>dataframe_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">single_mab_simulation</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">as.data.frame</span>(tanf_large),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="at">assignment_method =</span> <span class="st">&quot;Batch&quot;</span>,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">period_length =</span> <span class="dv">3000</span>,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">&quot;Thomspon&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="at">whole_experiment =</span> <span class="cn">FALSE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="at">prior_periods =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="at">blocking =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>    <span class="at">id_col =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>    <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>    <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  ),</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">5000</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>))</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>datatable_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">single_mab_simulation</span>(</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="at">data =</span> tanf_large,</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="at">assignment_method =</span> <span class="st">&quot;Batch&quot;</span>,</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="at">period_length =</span> <span class="dv">3000</span>,</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">&quot;UCB1&quot;</span>,</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  <span class="at">whole_experiment =</span> <span class="cn">FALSE</span>, <span class="at">perfect_assignment =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>  <span class="at">prior_periods =</span> <span class="st">&quot;All&quot;</span>,</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>  <span class="at">blocking =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>  <span class="at">data_cols =</span> <span class="fu">c</span>(</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>    <span class="at">id_col =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>    <span class="at">success_col =</span> <span class="st">&quot;success&quot;</span>,</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>    <span class="at">condition_col =</span> <span class="st">&quot;condition&quot;</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>  ),</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">5000</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>))</span></code></pre></div>
<p>The data.table version completes in 83.11 seconds while the
data.frame version takes 275.99 seconds making the the data.table
version 232% faster in this case.</p>
<p>The data.table version may not be faster in all cases. Performance
depends on the size of the data, the number of observations in each
period, and the total number of periods. For simulations where each
period contains fewer than 500 observations or the total size is less
than 1,000,000 rows, the data.table version will likely be slower.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hadad2021a" class="csl-entry">
Hadad, Vitor, David A. Hirshberg, Ruohan Zhan, Stefan Wager, and Susan
Athey. 2021. <span>“Confidence Intervals for Policy Evaluation in
Adaptive Experiments.”</span> <em>Proceedings of the National Academy of
Sciences of the United States of America</em> 118 (15): e2014602118. <a href="https://doi.org/10.1073/pnas.2014602118">https://doi.org/10.1073/pnas.2014602118</a>.
</div>
<div id="ref-kuleshov2014" class="csl-entry">
Kuleshov, Volodymyr, and Doina Precup. 2014. <span>“Algorithms for
Multi-Armed Bandit Problems.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.1402.6028">https://doi.org/10.48550/arXiv.1402.6028</a>.
</div>
<div id="ref-moore2022" class="csl-entry">
Moore, Ryan T., Katherine N. Gan, Karissa Minnich, and David Yokum.
2022. <span>“Anchor Management: A Field Experiment to Encourage Families
to Meet Critical Programme Deadlines.”</span> <em>Journal of Public
Policy</em> 42 (4): 615–36. <a href="https://doi.org/10.1017/S0143814X21000131">https://doi.org/10.1017/S0143814X21000131</a>.
</div>
<div id="ref-offer-westort2021" class="csl-entry">
Offer-Westort, Molly, Alexander Coppock, and Donald P. Green. 2021.
<span>“Adaptive <span>Experimental Design</span>: <span>Prospects</span>
and <span>Applications</span> in <span>Political Science</span>.”</span>
<em>American Journal of Political Science</em> 65 (4): 826–44. <a href="https://doi.org/10.1111/ajps.12597">https://doi.org/10.1111/ajps.12597</a>.
</div>
<div id="ref-slivkins2024" class="csl-entry">
Slivkins, Aleksandrs. 2024. <span>“Introduction to <span>Multi-Armed
Bandits</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.1904.07272">https://doi.org/10.48550/arXiv.1904.07272</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
